<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<title>购物车</title>
    <script type="text/jscript">
		document.write('<link rel="stylesheet" href="css/jquery.mobile-1.4.2.min.css">');
		document.write('<link rel="stylesheet" href="css/mian.css" />');
		document.write('<link rel="stylesheet" href="css/jquery.msgbox.css">');
	</script>
	<script src="js/jquery.js"></script>
	<script src="js/jquery.mobile-1.4.2.min.js"></script>
	<script src="js/jquery.msgbox.min.js"></script>   <!--messageBos  -->
        <script>
	   var AllAddress;  //所有的收货地址信息
	
	//事件处理
	$(document).on("pageinit","#shoping-car-page",function(){
		$("#AddressAdd").click(function(){
			window.location="AddAddress.html";
			window.location.load();	
		});
	})
	//加载购物车信息
	$(document).on("pageshow","#shoping-car-pag",function(){
		//$("#ShopCarList").find('li').remove();  //清空列表
		$.mobile.loading('show',{text:"请稍后...",textVisible:true,theme:"b"});
		$.ajax({
			url:localStorage.getItem("Register_Url")+"SS_GetCart_After",
			type:"GET",
			data:{AAccess_token:localStorage.getItem("access_token"),ACookieID:localStorage.getItem("CookieID")},
			dataType:"jsonp",
			jsonp:"BaseCallback",
			contentType:"application/json; charset=utf-8",
			success:function(data){
				$.mobile.loading("hide");
				//alert(data);
				var data_json = JSON.parse(data); 
				//alert(JSON.stringify(data_json.entries));
				if(data_json.entries.length>0){
					for(var i=0;i<data_json.entries.length;i++){
						//alert(JSON.stringify(data_json.entries[i]));
						   
					 
					         var address=' <li><div class="list-itme">'+
							  '<table border="0px" cellpadding="0" cellspacing="0" style=" width:100%;"><tr>'+
                	          '<td class="choose-btn"><input type="checkbox"/></td><td class="imge-div">'+
                    	      '<img src="image/order/pie.png" style="width:76px; height:76px; margin-left:2px; margin-top:1px; display:block;"/></td> <td class="name-descreble">'+
                    	      '<div class="name"><p class="text-p">'+data_json.entries[i].product.name+'</p>'+
                              '</div> <div class="describe"><p class="text-p">商品说明：阿斯顿发阿斯顿斯顿发</p>'+
                              '</div></td><td class="count-price"><div class="price"'+data_json.entries[i].basePrice.formattedValue+'</div>'+
                              '<div class="shoping-count" ><img src="image/button-30.png" id="add" /> '+
                              '<span>×'+data_json.entries[i].quantity+'</span><img src="image/button-34.png" id="reduce"/> </div>'+
                              '</td></tr></table></div></li>';
					
						$("#ShopCarList").append(address);
					}
					AllAddress = data;  //赋值
				}
				$("#ShopCarList").listview('refresh');
			},
			error:function(msg){
				$.mobile.loading("hide");
				alert(JSON.stringify(msg));
				//window.location="Login.html";
				//window.location.load();	
			}
		});
	});
	
	
    </script>
</head>
<body>
	
    <div data-role="page" id="shoping-car-page" class="jqm-hxyy">
    	<div data-role="header" class="jqm-header" data-position="fixed">
    		<a href="#" data-rel="back"><img src="image/button-48.png" /></a>
    		<h1>购物车</h1>
    	</div>
    	<div data-role="content" class="jqm-content shopingcar-content">
        	  <ul id="ShopCarList"  >
                 <li>
                   <div class="list-itme">
                     <table border="0px" cellpadding="0" cellspacing="0" style=" width:100%;">
            	<tr>
                	<td class="choose-btn">
                    	<!--  <input type="checkbox"/>  -->
                        <input type="checkbox" id="dlj-agreement" />
                        <label for="dlj-agreement" class="dlj-agreement"></label>
                        
                    </td>
                    <td class="imge-div">
                    	<img src="image/order/pie.png" style="width:76px; height:76px; margin-left:2px; margin-top:1px; display:block;"/>
                    </td>
                    <td class="name-descreble">
                    	<div class="name">
                        	<p class="text-p">商品名称：阿道夫爱的色放阿斯顿发阿斯顿发阿斯顿发撒地方阿斯顿发阿斯sdf sdf 顿发按时的</p>
                        </div>
                        <div class="describe">
                        	<p class="text-p">商品说明：阿斯顿发阿斯顿发阿斯顿发撒地方阿斯顿发</p>
                        </div>
                    </td>
                    <td class="count-price">
                    	<div class="price">
                        	200￥
                        </div>
                        <div class="shoping-count" >
                          <img src="image/button-30.png" id="add" /> 
                          <span>×2</span>
                          <img src="image/button-34.png" id="reduce"/>
                        </div>
                    </td>
                </tr>
                
            </table>
                   </div>
                 </li>
              </ul>
    	</div>
        <div data-role="footer" class="jqm-footer" data-position="fixed">
            <div data-role="navbar" data-theme="c">
            	<ul>
                    <li><a href="Home.html" rel="external" data-icon="home" >首页</a></li>
                    <li><a href="Query.html" rel="external" data-icon="search" >发现</a></li>
                    <li><a href="Category.html" rel="external" data-icon="bars">分类</a></li>
                    <li><a href="ShoppingCart.html" rel="external"  data-icon="star" class="ui-btn-active">购物车</a></li>
                    <li><a href="PersonalCenter.html" rel="external" data-icon="user">个人中心</a></li>
                </ul>
            </div>
        </div>
    </div>
</body>
</html>