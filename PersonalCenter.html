<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<title>个人中心</title>
    <script type="text/jscript">
		document.write('<link rel="stylesheet" href="css/jquery.mobile-1.4.2.min.css">');
		document.write('<link rel="stylesheet" href="css/mian.css" />');
		document.write('<link rel="stylesheet" href="css/jquery.msgbox.css">');
	</script>
	<script src="js/jquery.js"></script>
	<script src="js/jquery.mobile-1.4.2.min.js"></script>
	<script src="js/jquery.msgbox.min.js"></script>   <!--messageBos  -->
    <script>
	 
	
	//事件处理
	$(document).on("pageinit","#user-center-page",function(){
		var CarPage = localStorage.getItem("shop_car_count");
		if(CarPage != null && CarPage!=""){
			var car_count = document.getElementById("buy_car_count");  
		    car_count.style.display="";
		    $("#buy_car_count").html(CarPage);
		}
		var access_token = localStorage.getItem("access_token");
		if(access_token == null || access_token == ""){
			window.location="Login.html";
			localStorage.setItem("come_from_page","PersonalCenter.html");  //登录页面的来源
			window.location.load();	
		}else{
			//alert(localStorage.getItem("H_M_URL")+"yxtws/v1/hxyxt/customers/current?access_token="+localStorage.getItem("access_token"));
			$.mobile.loading('show',{text:"正在获取信息...",textVisible:true,theme:"b"});
		    $.ajax({
			url:localStorage.getItem("H_M_URL")+"yxtws/v1/hxyxt/customers/current",
			type:"GET",
			data:{access_token:localStorage.getItem("access_token")},
			dataType:"json",
			contentType:"application/x-www-form-urlencoded; charset=utf-8",
			success:function(data){
				$.mobile.loading("hide");
				//alert("成功"+JSON.stringify(data));
				$("#user_name").html(data.name);
				
			
			},
			error:function(msg){
				$.mobile.loading("hide");
			    $.msgbox({closeImg: 'image/close.gif',height:150,width:250,type :'alert',content:"获取失败"});
		

				
			}
		});
       
		}
		
		$("#look_all_orders").click(function(){
			window.location="MyOrder.html?order_class_id=1";
			window.location.load();	
		});
	})

	$(document).on("pageshow","#user-center-page",function(){
		
	});
	
	
    </script>
</head>
<body>
	<div data-role="page" id="user-center-page" class="jqm-hxyy">
    	<div data-role="header" class="jqm-header" data-position="fixed">
    		<a href="#" data-rel="back"><img src="image/button-48.png" /></a>
    		<h1>个人中心</h1>
             <a href="#"><img src="image/user/button-42.png" /> </a>
    	</div>
    	 <div class="personCentContent">
            <div class="perPhoto">
                <img src="image/order/button-65.png" alt="">
            </div>
            <div class="bgImg">
                <img src="image/goods/04.jpg" alt="">
            </div>
            <div class="perInfoList">
                <p id="user_name">会员名：Rabba</p>
                <p id="look_all_orders">查看全部订单>></p>
            </div>

        </div>
        <div data-role="content" class="department yyg_perInfoContent" id="user_center_content">
            <div class="wj-conTit">
                <ul>
                    <li class="on" id="tb_11">
                        <a href="#" onClick=OnclickClass(2) data-ico="" class="yyg_waitPay">
                            <label>待付款</label>
                        </a>
                    </li>
                    <li id="tb_12">
                        <a href="#" onClick=OnclickClass(3) data-ico="" class="yyg_waitSend">
                            <label for="">待发货</label>
                        </a>
                    </li>
                    <li id="tb_13">
                        <a href="#" onClick=OnclickClass(4) data-ico="" class="yyg_waitGet">
                            <label for="">待收货</label>
                        </a>
                    </li>
                    
                </ul>
            </div>
            <div class="yyg_disInfo">
                <ul>
                    <li>
                        <span data-ico="" class="yyg_EmaiIco">|</span><a rel="external" href="AddressCon.html"><span class="disInfoWord">管理收货地址</span><span class="icoFr fr">></span></a>
                    </li>
                    <li>
                        <span data-ico="" class="yyg_persetIco">|</span><a rel="external" href="personSet.html"><span class="disInfoWord">个人设置</span><span class="icoFr fr">></span></a>

                    </li>
                </ul>
            </div>

        </div>
         <div data-role="footer" class="jqm-footer" data-position="fixed">
            <div data-role="navbar" data-theme="c">
                <ul>
                    <li>
                        <a href="Home.html" rel="external" data-ico="" class="yyg-hom ">
                            <label>首页</label>
                        </a>
                    </li>
                    <li>
                        <a href="Query.html" rel="external" data-icon="" class="yyg-find">
                            <label>团购</label>
                        </a>
                    </li>
                    <li>
                        <a href="Category.html" rel="external" data-icon="" class="yyg-class">
                            <label>分类</label>
                        </a>
                    </li>
                    <li>
                        <a href="ShoppingCart.html" rel="external" data-icon="" class="yyg-buyCar">
                            <label>购物车</label>
                            <div id="buy_car_count" class="buyCarCount" style="display:none">0</div>
                        </a>
                    </li>
                    <li>
                        <a href="PersonalCenter.html" rel="external" data-icon="" class="ui-btn-active yyg-person">
                            <label>个人中心</label>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</body>
 <script>
    function tab(e) {
        var elm = $(e),
            tabs = elm.find('ul li'),
            tabc = elm.find('.department_c');
        tabs.each(function(i) {
            $(tabs[i]).on('click', function() {
                tabs.each(function() {
                    tabs.hasClass('on') ? tabs.removeClass('on') : false;
                }) 
                $(tabs[i]).addClass('on');
            })
        })
    }
    tab('#user_center_content')
	function OnclickClass(i){
		window.location="MyOrder.html?order_class_id="+i;
		window.location.load();	
	}
    </script>
</html>